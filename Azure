#Azure CLI
1. az login
1. az provider register -n Microsoft.ContainerService

# create a resource group
2. az group create --name marcy-aks --locatino eastus

#check the resource group
3. az group list

#create a new kubernetes cluster with one node (kubelive is the cluster name)
4. az aks create --resource-group marcy-aks --name kubelive --node-count 1 --generate-ssh-keys

#show us the available clusters
5. az aks list

# cube CTL is what we are going to use to talk  to the kubernetes cluster
6. az aks install-cli

cd ~
cd .kube/
ls

# kube Configuration => everything you need to kube CTL to talk to the endpoint will be configure (kubelive is the cluster name)
7. az aks get-credentials --resource-group marcy-aks --name kubelive

#get kubernetes nodes
8. kubectl get nodes

#get component status
9. kubectl get cs

#get cluster info
10. kubectl cluster-info

#Deploy an appication
11. kubectl create -f  app.yaml

#watch the pods
12. kubectl get po --watch

#watch the services
13. kubectl get svc --watch

#take a pod an expose it to the outside wolrd
14. kubectl expose pod <pod name> --port=80 --target-port=80 --type=LoadBalancer

#scale a cluster
15. az aks scale <name of the cluster> 

#Upgrade the kubernetes version
16.az aks upgrade  

#set the location
17. az configure -d group=java_demo location=eastus

#create a secure private registry
18. az acr create --admin-enabled --resource-group marcy-aks --name infomarcy --sku Basic

#export registry credentials
19. export DOCKER_REGISTRY=$(az acr show --name infomarcy --query loginServer --output tsv)
20.  export  DOCKER_USER=infomarcy
21.export DOCKER_PASSWORD=$(az acr credential show --name infomarcy --query passwords[0].value --output tsv)

#find the maven configuration
22. less ~/.m2/settings.xml

#deploy java app to docker as an image using maven
23. mvn package docker:build -DpushImage

#java App pom

	<properties>
		<project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
		<project.reporting.outputEncoding>UTF-8</project.reporting.outputEncoding>
		<java.version>1.8</java.version>
		<docker.image.prefix>${env.DOCKER_REGISTRY}</docker.image.prefix>
		<docker.registry>${env.DOCKER_REGISTRY}</docker.registry>
	</properties>
  
  <build>
	<finalName>${project.artifactId}</finalName>
		<plugins>
			<plugin>
				<groupId>org.springframework.boot</groupId>
				<artifactId>spring-boot-maven-plugin</artifactId>
			</plugin>
			
			<!-- PLUGIN DOCKER -->
			<plugin>
			<groupId>com.spotify</groupId>
			<artifactId>docker-maven-plugin</artifactId>
			<version>0.4.11</version>
			<configuration>
			<imageName>${docker.image.prefix}/${project.artifactId}</imageName>
			<dockerDirectory>src/main/docker</dockerDirectory>
			<resources>
				<resource>
				<targetPath>/</targetPath>
				<directory>${project.build.directory}</directory>
				<include>${project.build.finalName}.jar</include>
				</resource>
			</resources>
			<serverId>${docker.registry}</serverId>
			<registryUrl>https://${docker.registry}</registryUrl>
			</configuration>
			
			</plugin>
			
		</plugins>
	</build>
